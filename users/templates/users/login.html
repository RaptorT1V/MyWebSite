{% extends 'base.html' %}

{% block content %}
  <h2 style="color: red">Login</h2>

  <!-- Всплывающее сообщение -->
  <div id="popup-message" class="popup-message"></div>

  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Login</button>
  </form>

  <h2 style="color: red">Login</h2>

  <script>
    // Функция для показа всплывающего сообщения
    function showPopupMessage(message) {
        const popup = document.getElementById('popup-message');
        popup.textContent = message;

        if (message.trim() !== "") {  // Проверяем, есть ли текст сообщения
            popup.classList.add('show');
            setTimeout(() => {
                popup.classList.remove('show');
            }, 5000); // Сообщение исчезает через 5 секунд
        }
    }

    // Показываем сообщение при ошибке
    {% if error %}
    showPopupMessage("{{ error }}");
    {% endif %}

    // Логика для изменения цвета кнопки при заполнении всех полей
    const form = document.querySelector('form');
    const button = form.querySelector('button');

    form.addEventListener('input', function () {
        const allFieldsFilled = [...form.elements].every(input => input.value);
        if (allFieldsFilled) {
            button.classList.add('active');
        } else {
            button.classList.remove('active');
        }
    });

    // Код для удаления всплывающего сообщения через 5 секунд
    window.addEventListener('DOMContentLoaded', function () {
        const messageBox = document.getElementById('popup-message');

        if (messageBox && messageBox.textContent.trim() !== "") {  // Проверяем наличие текста в элементе
            // Показываем сообщение и запускаем таймер на удаление блока
            messageBox.classList.add('show');

            setTimeout(function () {
                // Сначала скрываем блок
                messageBox.classList.remove('show');

                // Затем полностью удаляем его из DOM
                setTimeout(function () {
                    messageBox.remove();
                }, 500);  // Дожидаемся окончания анимации скрытия
            }, 5000);  // Через 5 секунд начинаем скрывать
        }
    });
  </script>

{% endblock %}
